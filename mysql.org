#+TITLE: mysql相关命令参考
#+AUTHOR: vermin
#+OPTIONS: H:3 TOC:t
#+DESCRIPTION: mysql相关记录

* 导航                                                             :TOC_2_gh:
- [[#相关问题处理方式][相关问题处理方式]]
  - [[#mysql连接数满][mysql连接数满]]
  - [[#授权][授权]]
- [[#mysql相关原理备忘][MySQL相关原理备忘]]
  - [[#mgr][MGR]]
  - [[#mysql日志类型][MySQL日志类型]]

* 相关问题处理方式
** mysql连接数满
   通过gdb动态调整连接数，然后连进去后处理
   #+begin_src sh
   gdb -p ${pid} -ex "set max_connections = 10000" -batch
   #+end_src
** 授权
   #+begin_src sql
   GRANT create,alter,select,update,insert,delete ON *.* TO user@"%.%.%.%" IDENTIFIED BY 'passwd';
   GRANT REPLICATION SLAVE ON *.* TO rep@%.%.%.% IDENTIFIED BY 'rep';
   flush privileges;
   #+end_src
* MySQL相关原理备忘
** MGR
MGR paxos协议同步，多主模式
MHA 一主2从，优先级切换，选择gtid最大的备机同步
** MySQL日志类型
- binlog
  主从复制使用，事务提交的时候，一次性记录到磁盘中

  按照expire_logs_days来保存数据
- redolog
  记录物理数据页面写修改信息，顺序写入，事务执行过程中就写入，刷入磁盘以后，就释放

  ib_logfilexxx
